<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur de rappels suisse - Calculer frais de rappel et intérêts moratoires</title>
    <link rel="icon" type="image/svg+xml" href="../favicon.svg">
    <meta name="description" content="Calculez les frais de rappel et intérêts moratoires pour vos créances. Avec plusieurs niveaux de rappel et taux d'intérêt légal selon CO art. 104.">
    <meta name="keywords" content="calculateur rappel, frais de rappel, intérêts moratoires, rappel, Suisse, CO art. 104, recouvrement">
    <meta name="author" content="Durchblick Consultancy BV">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://verzugszinsrechner.ch/fr/mahnrechner.html">
    <meta property="og:title" content="Calculateur de rappels suisse - Calculer frais de rappel">
    <meta property="og:description" content="Calculez les frais de rappel et intérêts moratoires pour vos créances. Avec plusieurs niveaux de rappel.">
    <meta property="og:image" content="https://verzugszinsrechner.ch/images/og-zins-fr.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="fr_CH">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Calculateur de rappels suisse - Calculer frais de rappel">
    <meta name="twitter:description" content="Calculez les frais de rappel et intérêts moratoires pour vos créances. Avec plusieurs niveaux de rappel.">
    <meta name="twitter:image" content="https://verzugszinsrechner.ch/images/og-zins-fr.png">

    <!-- Canonical & Language -->
    <link rel="canonical" href="https://verzugszinsrechner.ch/fr/mahnrechner.html">
    <link rel="alternate" hreflang="de" href="https://verzugszinsrechner.ch/de/mahnrechner.html">
    <link rel="alternate" hreflang="fr" href="https://verzugszinsrechner.ch/fr/mahnrechner.html">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "Calculateur de rappels suisse",
        "description": "Calculez les frais de rappel et intérêts moratoires pour vos créances",
        "url": "https://verzugszinsrechner.ch/fr/mahnrechner.html",
        "applicationCategory": "LegalService",
        "operatingSystem": "Web",
        "inLanguage": "fr-CH",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CHF"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Durchblick Consultancy BV",
            "url": "https://durchblick.nl"
        }
    }
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Economica:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .tool-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tool-nav a {
            padding: 8px 16px;
            background: #f5f5f5;
            border-radius: 4px;
            text-decoration: none;
            color: #3f606f;
            font-family: 'Economica', sans-serif;
            font-weight: 600;
            transition: all 0.2s;
        }
        .tool-nav a:hover {
            background: #e0e0e0;
        }
        .tool-nav a.active {
            background: #3f606f;
            color: white;
        }
        .reminder-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 10px;
            align-items: end;
            margin-bottom: 10px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .reminder-row .form-group {
            margin-bottom: 0;
        }
        .reminder-row label {
            font-size: 0.9rem;
        }
        .remove-reminder {
            padding: 8px 12px;
            background: #cc5c53;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            height: 42px;
        }
        .remove-reminder:hover {
            background: #b04a42;
        }
        .add-reminder {
            margin-top: 10px;
            padding: 10px 20px;
            background: #5a8a9d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: 'Economica', sans-serif;
            font-weight: 600;
        }
        .add-reminder:hover {
            background: #4a7a8d;
        }
        .reminder-number {
            font-weight: bold;
            color: #3f606f;
            margin-bottom: 5px;
        }
        @media (max-width: 600px) {
            .reminder-row {
                grid-template-columns: 1fr;
            }
            .remove-reminder {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-row">
            <button type="button" class="dark-mode-toggle" aria-label="Basculer le mode sombre" onclick="DarkMode.toggle()">
                <i class="fas fa-moon"></i>
            </button>
            <div class="language-switcher">
                <a href="../de/mahnrechner.html" class="lang-btn">DE</a>
                <a href="../fr/mahnrechner.html" class="lang-btn active">FR</a>
            </div>
        </div>

        <h1><img src="../favicon.svg" alt="" class="title-icon">Calculateur de rappels suisse</h1>

        <nav class="tool-nav">
            <a href="../fr/">Calculateur d'intérêts</a>
            <a href="../fr/mahnrechner.html" class="active">Calculateur de rappels</a>
        </nav>

        <div class="steps-container">
            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-file-invoice"></i>
                    <div class="step-number">1</div>
                </div>
                <div class="step-content">
                    <h3>Saisir la facture</h3>
                    <p>Entrez le montant initial de la facture et la date d'échéance.</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-envelope"></i>
                    <div class="step-number">2</div>
                </div>
                <div class="step-content">
                    <h3>Ajouter les rappels</h3>
                    <p>Saisissez les rappels envoyés avec date et frais (habituel: CHF 20-50).</p>
                </div>
            </div>

            <div class="step-card">
                <div class="step-icon">
                    <i class="fas fa-calculator"></i>
                    <div class="step-number">3</div>
                </div>
                <div class="step-content">
                    <h3>Créance totale</h3>
                    <p>Obtenez le total incluant capital, frais de rappel et intérêts moratoires.</p>
                </div>
            </div>
        </div>

        <div class="calculator-card">
            <form id="mahnForm">
                <div class="form-group">
                    <label for="principal" class="required">Montant de la facture (CHF)
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Le montant initial de la facture sans frais de rappel.</span>
                        </span>
                    </label>
                    <div class="currency-input-wrapper">
                        <input type="text"
                               id="principal"
                               name="principal"
                               required
                               placeholder="p.ex. 1'500.00"
                               title="Montant de la facture en CHF">
                    </div>
                </div>

                <div class="form-group">
                    <label for="invoiceDate" class="required">Date d'échéance de la facture
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">La date jusqu'à laquelle la facture devait être payée. La demeure commence le lendemain.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="invoiceDate"
                           name="invoiceDate"
                           required
                           title="Date d'échéance"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: JJ.MM.AAAA</small>
                </div>

                <div class="form-group">
                    <label>Rappels
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Ajoutez tous les rappels envoyés. Frais habituels: 1er rappel CHF 0-20, 2e rappel CHF 20-30, 3e rappel CHF 30-50.</span>
                        </span>
                    </label>
                    <div id="remindersContainer">
                        <div class="reminder-row" data-reminder="1">
                            <div class="form-group">
                                <div class="reminder-number">1er rappel</div>
                                <label for="reminderDate1">Date</label>
                                <input type="text" id="reminderDate1" name="reminderDate1" class="reminder-date" pattern="\d{2}\.\d{2}\.\d{4}" placeholder="JJ.MM.AAAA">
                            </div>
                            <div class="form-group">
                                <label for="reminderFee1">Frais de rappel (CHF)</label>
                                <div class="currency-input-wrapper">
                                    <input type="text" id="reminderFee1" name="reminderFee1" class="reminder-fee" placeholder="p.ex. 20.00" value="20.00">
                                </div>
                            </div>
                            <button type="button" class="remove-reminder" onclick="removeReminder(this)" style="visibility: hidden;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" class="add-reminder" onclick="addReminder()">
                        <i class="fas fa-plus"></i> Ajouter un rappel
                    </button>
                </div>

                <div class="form-group">
                    <label for="endDate" class="required">Date de calcul (jusqu'au)
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">La date jusqu'à laquelle le calcul doit être effectué. Souvent la date d'aujourd'hui.</span>
                        </span>
                    </label>
                    <input type="text"
                           id="endDate"
                           name="endDate"
                           required
                           title="Date de calcul"
                           pattern="\d{2}\.\d{2}\.\d{4}">
                    <small class="form-hint">Format: JJ.MM.AAAA</small>
                </div>

                <div class="form-group">
                    <label for="rateType">Taux d'intérêt
                        <span class="info-tooltip">
                            <span class="info-icon">?</span>
                            <span class="tooltip-content">Le taux d'intérêt moratoire légal est de 5% par an (CO art. 104).</span>
                        </span>
                    </label>
                    <select id="rateType" name="rateType" onchange="toggleCustomRate()">
                        <option value="5">Taux légal: 5% p.a. (CO art. 104)</option>
                        <option value="custom">Taux contractuel</option>
                    </select>
                </div>

                <div class="form-group" id="customRateGroup" style="display: none;">
                    <label for="customRate" class="required">Taux contractuel (% p.a.)</label>
                    <input type="number"
                           id="customRate"
                           name="customRate"
                           step="0.01"
                           min="0"
                           max="100"
                           placeholder="p.ex. 8.5"
                           class="form-control">
                </div>

                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    Attention: Ce calculateur sert uniquement à titre indicatif. Les frais de rappel doivent être appropriés et ne peuvent pas être excessifs.
                </div>

                <button type="submit">Calculer la créance totale</button>
            </form>

            <div id="result" class="result" style="display: none;">
                <div class="result-actions">
                    <button type="button" onclick="exportPDF()" class="print-button">
                        <i class="fas fa-file-pdf"></i> Enregistrer en PDF
                    </button>
                    <button type="button" onclick="copyMahnResult()" class="btn btn-secondary copy-btn">
                        <i class="fas fa-copy"></i> Copier
                    </button>
                    <a href="https://gerichtskostenrechner.ch/fr/betreibung.html" class="btn btn-secondary" target="_blank" rel="noopener">
                        <i class="fas fa-arrow-right"></i> Continuer vers la poursuite
                    </a>
                </div>
                <div class="result-summary"></div>
            </div>
        </div>

        <div class="info-cards-container">
            <div class="info-step-card highlight">
                <div class="step-icon">
                    <i class="fas fa-info-circle"></i>
                </div>
                <div class="step-content">
                    <h3>Frais de rappel en Suisse</h3>
                    <p>Les frais de rappel ne sont pas réglementés par la loi, mais doivent être <strong>appropriés</strong>. Valeurs indicatives:</p>
                    <ul>
                        <li><strong>1er rappel:</strong> CHF 0–20 (souvent gratuit comme rappel de paiement)</li>
                        <li><strong>2e rappel:</strong> CHF 20–30</li>
                        <li><strong>3e rappel:</strong> CHF 30–50</li>
                    </ul>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-gavel"></i>
                </div>
                <div class="step-content">
                    <h3>Base légale</h3>
                    <p>Les frais de rappel sont dus comme <strong>dommages-intérêts</strong> selon CO art. 97 ss. Ils doivent refléter les frais réels (port, matériel, temps de travail).</p>
                    <p style="margin-top: 0.5rem;">Des frais de rappel excessifs peuvent être contestés comme <strong>abusifs</strong>.</p>
                    <p style="margin-top: 0.5rem;"><a href="https://www.justis.ch/fr/renseignements_juridiques/artikel/finances/dois-je-payer-les-frais-de-rappel" target="_blank" rel="noopener">Plus d'infos sur Justis.ch <i class="fas fa-external-link-alt"></i></a></p>
                </div>
            </div>

            <div class="info-step-card">
                <div class="step-icon">
                    <i class="fas fa-percent"></i>
                </div>
                <div class="step-content">
                    <h3>Intérêts moratoires</h3>
                    <p>En plus des frais de rappel, des <strong>intérêts moratoires de 5%</strong> sont dus (CO art. 104). Ils sont calculés sur le capital, pas sur les frais de rappel.</p>
                    <p style="margin-top: 0.5rem;"><a href="../fr/">Vers le calculateur d'intérêts <i class="fas fa-arrow-right"></i></a></p>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <p><a href="https://durchblick.nl/tools_fr.html" target="_blank" rel="noopener">Durchblick Consultancy BV – Outils juridiques gratuits pour la Suisse</a></p>
            <p class="footer-disclaimer">Ce calculateur sert uniquement d'orientation. Pas de conseil juridique.</p>
            <p class="footer-privacy">Tous les calculs sont effectués directement dans votre navigateur. Aucune donnée utilisateur n'est collectée ni stockée.</p>
        </div>
    </footer>

    <div class="print-header" style="display: none;">
        <img src="https://www.durchblick.nl/images/durchblick_logo.svg"
             alt="Durchblick Consultancy Logo">
        <div>
            <h2>Calcul des frais de rappel</h2>
            <p id="printDate" style="font-size: 0.9rem; color: #666; margin-top: 0.25rem;"></p>
        </div>
    </div>

    <div class="print-footer" style="display: none;">
        <p><strong>verzugszinsrechner.ch</strong> – Calculateur de rappels selon le Code des obligations suisse</p>
        <p>Cette impression sert uniquement à titre indicatif. Pas de conseil juridique.</p>
    </div>

    <div id="disclaimerModal" class="modal">
        <div class="modal-content">
            <h2>Avis juridique</h2>
            <div class="disclaimer-text">
                <p><strong>Exclusion de responsabilité et conditions d'utilisation</strong></p>
                <p>Durchblick Consultancy BV met ce calculateur de rappels à disposition en tant qu'outil indicatif sans engagement. Malgré un développement soigneux, aucune garantie ne peut être donnée quant à l'exactitude des calculs.</p>

                <p>Il est notamment précisé:</p>
                <ul>
                    <li>Le calculateur sert uniquement à titre indicatif et ne remplace pas un conseil juridique.</li>
                    <li>Les frais de rappel doivent être appropriés et peuvent être contestés.</li>
                    <li>Durchblick Consultancy BV décline toute responsabilité pour les dommages résultant de l'utilisation.</li>
                </ul>

                <p>En utilisant ce service, vous acceptez ces conditions.</p>
            </div>
            <button onclick="acceptDisclaimer()" class="accept-button">
                J'ai lu l'avis et j'accepte les conditions
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="../scripts/utils.js"></script>
    <script src="../scripts/calculations.js"></script>
    <script>
        let reminderCount = 1;
        let lastMahnData = null;

        function addReminder() {
            reminderCount++;
            const container = document.getElementById('remindersContainer');
            const row = document.createElement('div');
            row.className = 'reminder-row';
            row.dataset.reminder = reminderCount;

            const ordinal = reminderCount === 2 ? '2e' : reminderCount === 3 ? '3e' : `${reminderCount}e`;

            row.innerHTML = `
                <div class="form-group">
                    <div class="reminder-number">${ordinal} rappel</div>
                    <label for="reminderDate${reminderCount}">Date</label>
                    <input type="text" id="reminderDate${reminderCount}" name="reminderDate${reminderCount}" class="reminder-date" pattern="\\d{2}\\.\\d{2}\\.\\d{4}" placeholder="JJ.MM.AAAA">
                </div>
                <div class="form-group">
                    <label for="reminderFee${reminderCount}">Frais de rappel (CHF)</label>
                    <div class="currency-input-wrapper">
                        <input type="text" id="reminderFee${reminderCount}" name="reminderFee${reminderCount}" class="reminder-fee" placeholder="p.ex. ${reminderCount * 10 + 10}.00" value="${reminderCount * 10 + 10}.00">
                    </div>
                </div>
                <button type="button" class="remove-reminder" onclick="removeReminder(this)">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            container.appendChild(row);

            // Initialize flatpickr for new date input
            flatpickr(`#reminderDate${reminderCount}`, {
                dateFormat: "d.m.Y",
                allowInput: true
            });
        }

        function removeReminder(button) {
            const row = button.closest('.reminder-row');
            row.remove();
            // Renumber remaining reminders
            const rows = document.querySelectorAll('.reminder-row');
            rows.forEach((r, i) => {
                const num = i + 1;
                const ordinal = num === 1 ? '1er' : num === 2 ? '2e' : num === 3 ? '3e' : `${num}e`;
                r.querySelector('.reminder-number').textContent = `${ordinal} rappel`;
                r.dataset.reminder = num;
            });
            reminderCount = rows.length;
        }

        function toggleCustomRate() {
            const rateType = document.getElementById('rateType').value;
            const customGroup = document.getElementById('customRateGroup');
            customGroup.style.display = rateType === 'custom' ? 'block' : 'none';
        }

        function parseSwissNumber(str) {
            if (!str) return 0;
            // Remove all types of apostrophes, quotes, and spaces used as thousands separators
            return parseFloat(str.replace(/[''\u2019\u2018\u02BC\s]/g, '').replace(/,/g, '.')) || 0;
        }

        function formatCHF(amount) {
            return amount.toLocaleString('fr-CH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function parseDate(dateStr) {
            const parts = dateStr.split('.');
            if (parts.length !== 3) return null;
            return new Date(parts[2], parts[1] - 1, parts[0]);
        }

        function calculateDays(start, end) {
            const diffTime = end - start;
            return Math.floor(diffTime / (1000 * 60 * 60 * 24));
        }

        document.getElementById('mahnForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const principal = parseSwissNumber(document.getElementById('principal').value);
            const invoiceDate = parseDate(document.getElementById('invoiceDate').value);
            const endDate = parseDate(document.getElementById('endDate').value);
            const rateType = document.getElementById('rateType').value;
            const rate = rateType === 'custom' ? parseFloat(document.getElementById('customRate').value) : 5;

            if (!invoiceDate || !endDate) {
                alert('Veuillez entrer des dates valides.');
                return;
            }

            // Collect reminders
            const reminders = [];
            document.querySelectorAll('.reminder-row').forEach(row => {
                const dateInput = row.querySelector('.reminder-date');
                const feeInput = row.querySelector('.reminder-fee');
                if (dateInput.value) {
                    reminders.push({
                        date: parseDate(dateInput.value),
                        fee: parseSwissNumber(feeInput.value)
                    });
                }
            });

            // Calculate total reminder fees
            const totalFees = reminders.reduce((sum, r) => sum + r.fee, 0);

            // Calculate days and interest (from day after invoice date)
            const startDate = new Date(invoiceDate);
            startDate.setDate(startDate.getDate() + 1); // La demeure commence le lendemain
            const days = calculateDays(startDate, endDate);
            const interest = days > 0 ? (principal * rate / 100 * days / 360) : 0;

            // Total
            const total = principal + totalFees + interest;

            // Build result HTML
            let resultHTML = `
                <h3>Résumé</h3>
                <table class="result-table">
                    <tr>
                        <td>Montant de la facture:</td>
                        <td class="amount">CHF ${formatCHF(principal)}</td>
                    </tr>
            `;

            if (reminders.length > 0) {
                resultHTML += `
                    <tr>
                        <td colspan="2" style="padding-top: 10px;"><strong>Frais de rappel:</strong></td>
                    </tr>
                `;
                reminders.forEach((r, i) => {
                    if (r.fee > 0) {
                        const num = i + 1;
                        const ordinal = num === 1 ? '1er' : num === 2 ? '2e' : num === 3 ? '3e' : `${num}e`;
                        resultHTML += `
                            <tr>
                                <td style="padding-left: 20px;">${ordinal} rappel (${r.date.toLocaleDateString('fr-CH')}):</td>
                                <td class="amount">CHF ${formatCHF(r.fee)}</td>
                            </tr>
                        `;
                    }
                });
                resultHTML += `
                    <tr>
                        <td style="padding-left: 20px;"><strong>Total frais de rappel:</strong></td>
                        <td class="amount"><strong>CHF ${formatCHF(totalFees)}</strong></td>
                    </tr>
                `;
            }

            resultHTML += `
                <tr>
                    <td colspan="2" style="padding-top: 10px;"><strong>Intérêts moratoires:</strong></td>
                </tr>
                <tr>
                    <td style="padding-left: 20px;">Taux d'intérêt:</td>
                    <td>${rate}% p.a.</td>
                </tr>
                <tr>
                    <td style="padding-left: 20px;">Période de demeure:</td>
                    <td>${days} jours</td>
                </tr>
                <tr>
                    <td style="padding-left: 20px;">Intérêts moratoires:</td>
                    <td class="amount">CHF ${formatCHF(interest)}</td>
                </tr>
                <tr class="result-total">
                    <td><strong>Créance totale:</strong></td>
                    <td class="amount"><strong>CHF ${formatCHF(total)}</strong></td>
                </tr>
            </table>
            `;

            document.querySelector('.result-summary').innerHTML = resultHTML;
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });

            // Données pour export PDF
            lastMahnData = {
                principal: principal,
                reminders: reminders,
                totalFees: totalFees,
                rate: rate,
                days: days,
                interest: interest,
                total: total
            };
        });

        // Initialize date pickers
        document.addEventListener('DOMContentLoaded', function() {
            flatpickr("#invoiceDate", { dateFormat: "d.m.Y", allowInput: true });
            flatpickr("#endDate", { dateFormat: "d.m.Y", allowInput: true, defaultDate: "today" });
            flatpickr("#reminderDate1", { dateFormat: "d.m.Y", allowInput: true });
        });

        function printResult() {
            document.getElementById('printDate').textContent = 'Créé le: ' + new Date().toLocaleDateString('fr-CH');
            window.print();
        }

        // PDF Export
        function exportPDF() {
            if (!lastMahnData) {
                alert('Veuillez d\'abord effectuer un calcul.');
                return;
            }
            if (typeof MahnrechnerPdfExport !== 'undefined') {
                MahnrechnerPdfExport.generatePDF(lastMahnData, 'fr');
            } else {
                printResult();
            }
        }

        // Disclaimer modal
        function acceptDisclaimer() {
            document.getElementById('disclaimerModal').style.display = 'none';
            localStorage.setItem('mahnrechner_disclaimer_accepted', 'true');
        }

        document.addEventListener('DOMContentLoaded', function() {
            if (!localStorage.getItem('mahnrechner_disclaimer_accepted')) {
                document.getElementById('disclaimerModal').style.display = 'flex';
            }
        });

        // Copy result to clipboard
        function copyMahnResult() {
            if (!lastMahnData) return;

            const d = lastMahnData;
            let text = `Calcul des frais de rappel
Montant de la facture: CHF ${formatCHF(d.principal)}
`;
            if (d.reminders.length > 0) {
                text += `\nFrais de rappel:`;
                d.reminders.forEach((r, i) => {
                    if (r.fee > 0) {
                        const ordinal = i === 0 ? '1er' : (i + 1) + 'e';
                        text += `\n  ${ordinal} rappel: CHF ${formatCHF(r.fee)}`;
                    }
                });
                text += `\n  Total frais de rappel: CHF ${formatCHF(d.totalFees)}`;
            }
            text += `\n\nIntérêts moratoires:
  Taux: ${d.rate}% p.a.
  Période de demeure: ${d.days} jours
  Intérêts moratoires: CHF ${formatCHF(d.interest)}

Créance totale: CHF ${formatCHF(d.total)}

Calculé sur verzugszinsrechner.ch/fr/mahnrechner.html`;

            const button = document.querySelector('.copy-btn');
            ClipboardUtils.copy(text).then(success => {
                ClipboardUtils.showFeedback(button, success);
            });
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/3.0.3/jspdf.umd.min.js"></script>
    <script src="../scripts/pdf-export.js"></script>
</body>
</html>
